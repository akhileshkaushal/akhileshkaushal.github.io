<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Methylation-Pipeline | Akhilesh Kaushal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    body {
      background-color: #f9f9f9;
      font-family: 'Segoe UI', sans-serif;
      padding-top: 40px;
    }
    .section {
      margin-bottom: 2rem;
    }
    .tag-badge {
      background: #ddd;
      border-radius: 10px;
      padding: 2px 8px;
      font-size: 0.75rem;
      margin-right: 6px;
    }
    a.back-link {
      font-size: 0.9rem;
      text-decoration: none;
      color: #004466;
    }
    a.back-link:hover {
      text-decoration: underline;
    }
  </style>
</head>

<body>

  <div class="container">
    <a href="index.html" class="back-link">&larr; Back to Pipelines</a>

    <h1 class="mt-4">Methylation-Pipeline</h1>
    <p class="text-muted mb-3">A pipeline for preprocessing and differential analysis of Illumina EPIC methylation array data.</p>

    <div class="mb-3">
      <span class="tag-badge">Methylation</span>
      <span class="tag-badge">EPIC Array</span>
      <span class="tag-badge">limma</span>
      <span class="tag-badge">Preprocessing</span>
    </div>

    <div class="section">
      <h3>Overview</h3>
      <p>
        This pipeline handles Illumina EPIC array data starting from raw IDAT files. It includes probe quality control, background correction, normalization, and differential methylation analysis using <code>limma</code>. The pipeline also supports generation of beta and M-value matrices, and is compatible with downstream annotation and pathway enrichment analysis.
      </p>
    </div>

    <div class="section">
      <h3>Pipeline Steps</h3>
      <ul>
        <li>Import raw IDAT files using <code>minfi</code></li>
        <li>Probe and sample quality control</li>
        <li>Filtering of non-CpG, SNP, cross-reactive probes</li>
        <li>Background correction and normalization (e.g., SWAN, BMIQ)</li>
        <li>Extraction of beta-values and M-values</li>
        <li>Differential methylation analysis using <code>limma</code></li>
        <li>Export of DMPs, volcano plots, and annotation tables</li>
      </ul>
    </div>

    <div class="section">
      <h3>Usage</h3>
      <pre><code>Rscript run_methylation_pipeline.R config.yaml</code></pre>
      <p>
        Ensure your <code>config.yaml</code> includes paths to IDATs, sample sheet, annotation, and normalization options.
      </p>
    </div>

    <div class="section">
      <h3>Example Configuration</h3>
      <pre><code>input_idat_dir: /data/epic/idats/
sample_sheet: samplesheet.csv
normalization: BMIQ or SWAN
filter_cross_reactive: true
min_detection_p: 0.01</code></pre>
    </div>

    <div class="section">
      <h3>Output Files</h3>
      <ul>
        <li><code>beta_matrix.csv</code> — filtered and normalized beta-values</li>
        <li><code>m_matrix.csv</code> — logit-transformed methylation values</li>
        <li><code>differential_methylation.csv</code> — limma results</li>
        <li><code>volcano_plot.pdf</code>, <code>density_plot.png</code>, <code>multiqc.html</code></li>
      </ul>
    </div>

    <div class="section">
      <h3>References</h3>
      <ul>
        <li>Fortin, J.P. et al., <em>Functional normalization of 450k methylation array data improves replication in large cancer studies</em>, Genome Biology, 2014.</li>
        <li>Ritchie, M.E. et al., <em>limma powers differential expression analyses for RNA-sequencing and microarray studies</em>, NAR, 2015.</li>
      </ul>
    </div>

    <div class="section text-end">
      <a href="https://github.com/akhileshkaushal/methylation-pipeline" class="btn btn-outline-dark" target="_blank">
        View on GitHub
      </a>
    </div>
  </div>

</body>
</html>

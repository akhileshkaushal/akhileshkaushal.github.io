


<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Stage-to-Tool Mapping With Example Commands &mdash; WGS/WES Pipeline 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=9482ece9" />

  
    <link rel="canonical" href="https://akhileshkaushal.github.io/wgswes/wes_cll_methods.html" />
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=4ebf8126"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Case Study: ITH-aware Somatic Interpretation for WGS/WES" href="casestudy.html" />
    <link rel="prev" title="Pipeline Structure and Containerisation" href="structure_and_containerisation.html" />
   
  <link rel="icon" href="_static/images/favicon.ico">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            WGS/WES Pipeline
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Sections:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">WGS/WES Variant Calling Pipeline</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#use-cases">Use Cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#supported-data-types">Supported Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#when-to-choose-wgs-vs-wes">When to Choose WGS vs WES</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#design-principles">Design Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#high-level-workflow">High-Level Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#inputs-and-outputs">Inputs and Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#quality-coverage-and-qc">Quality, Coverage, and QC</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#filtering-strategy-notes">Filtering Strategy Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#reference-and-resource-recommendations">Reference and Resource Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#reproducibility-execution">Reproducibility &amp; Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#data-stewardship-compliance">Data Stewardship &amp; Compliance</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#limitations-non-goals">Limitations &amp; Non-Goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#whats-next">What’s Next</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="run_pipeline.html">Run the WGS/WES Pipeline</a><ul>
<li class="toctree-l2"><a class="reference internal" href="run_pipeline.html#pipeline-inputs-layout">Pipeline Inputs &amp; Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="run_pipeline.html#step-by-step-workflow">Step-by-Step Workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="run_pipeline.html#raw-read-qc">1) Raw Read QC</a></li>
<li class="toctree-l3"><a class="reference internal" href="run_pipeline.html#adapter-quality-trimming-optional-but-recommended-for-wes">2) Adapter/Quality Trimming (optional but recommended for WES)</a></li>
<li class="toctree-l3"><a class="reference internal" href="run_pipeline.html#alignment-to-reference">3) Alignment to Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="run_pipeline.html#duplicate-marking-bqsr">4) Duplicate Marking &amp; BQSR</a></li>
<li class="toctree-l3"><a class="reference internal" href="run_pipeline.html#variant-calling">5) Variant Calling</a></li>
<li class="toctree-l3"><a class="reference internal" href="run_pipeline.html#variant-filtering">6) Variant Filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="run_pipeline.html#annotation">7) Annotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="run_pipeline.html#cohort-level-qc-reports">8) Cohort-Level QC &amp; Reports</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="run_pipeline.html#parallelization-performance">Parallelization &amp; Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="run_pipeline.html#wes-specific-notes">WES-Specific Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="run_pipeline.html#expected-outputs">Expected Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="run_pipeline.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="run_pipeline.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="advanced_analysis.html">Advanced Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="advanced_analysis.html#trio-and-family-based-analysis">Trio and Family-Based Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_analysis.html#joint-calling-for-large-cohorts">Joint Calling for Large Cohorts</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_analysis.html#copy-number-variation-cnv-analysis">Copy Number Variation (CNV) Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_analysis.html#mitochondrial-variant-analysis">Mitochondrial Variant Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_analysis.html#tumor-purity-estimation-adjustment">Tumor Purity Estimation &amp; Adjustment</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_analysis.html#integration-and-reporting">Integration and Reporting</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_analysis.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="annotated_example.html">Annotated Examples &amp; Interpretation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="annotated_example.html#example-tumornormal-variant-calling">Example: Tumor–Normal Variant Calling</a></li>
<li class="toctree-l2"><a class="reference internal" href="annotated_example.html#example-tumor-only-variant-calling">Example: Tumor-Only Variant Calling</a></li>
<li class="toctree-l2"><a class="reference internal" href="annotated_example.html#example-germline-variant-calling">Example: Germline Variant Calling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="structure_and_containerisation.html">Pipeline Structure and Containerisation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="structure_and_containerisation.html#modular-workflow-overview">Modular Workflow Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="structure_and_containerisation.html#support-for-germline-and-somatic-calling">Support for Germline and Somatic Calling</a></li>
<li class="toctree-l2"><a class="reference internal" href="structure_and_containerisation.html#containerisation">Containerisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="structure_and_containerisation.html#scalability-and-workflow-automation">Scalability and Workflow Automation</a></li>
<li class="toctree-l2"><a class="reference internal" href="structure_and_containerisation.html#example-directory-layout">Example Directory Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="structure_and_containerisation.html#best-practices-for-execution">Best Practices for Execution</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Stage-to-Tool Mapping With Example Commands</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#example-commands-bash">Example commands (bash)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reproducibility-checklist">Reproducibility checklist</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="casestudy.html">Case Study: ITH-aware Somatic Interpretation for WGS/WES</a><ul>
<li class="toctree-l2"><a class="reference internal" href="casestudy.html#what-was-built">What Was Built</a></li>
<li class="toctree-l2"><a class="reference internal" href="casestudy.html#cohort-profiling-and-heterogeneity">Cohort Profiling and Heterogeneity</a></li>
<li class="toctree-l2"><a class="reference internal" href="casestudy.html#drug-screening-and-response-definition">Drug Screening and Response Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="casestudy.html#expression-signatures-predicting-response">Expression Signatures Predicting Response</a></li>
<li class="toctree-l2"><a class="reference internal" href="casestudy.html#mechanism-of-lenvatinib-resistance-combination-strategy">Mechanism of Lenvatinib Resistance &amp; Combination Strategy</a></li>
<li class="toctree-l2"><a class="reference internal" href="casestudy.html#ith-aware-somatic-interpretation-recommendations">ITH-aware Somatic Interpretation &amp; Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="casestudy.html#limitations">Limitations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a><ul>
<li class="toctree-l2"><a class="reference internal" href="references.html#primary-study">Primary Study</a></li>
<li class="toctree-l2"><a class="reference internal" href="references.html#supporting-literature">Supporting Literature</a></li>
<li class="toctree-l2"><a class="reference internal" href="references.html#databases-and-resources">Databases and Resources</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">WGS/WES Pipeline</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Stage-to-Tool Mapping With Example Commands</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/wes_cll_methods.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="structure_and_containerisation.html" class="btn btn-neutral float-left" title="Pipeline Structure and Containerisation" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="casestudy.html" class="btn btn-neutral float-right" title="Case Study: ITH-aware Somatic Interpretation for WGS/WES" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="stage-to-tool-mapping-with-example-commands">
<h1>Stage-to-Tool Mapping With Example Commands<a class="headerlink" href="#stage-to-tool-mapping-with-example-commands" title="Link to this heading"></a></h1>
<table class="docutils align-default">
<colgroup>
<col style="width: 18.0%" />
<col style="width: 22.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Stage</p></th>
<th class="head"><p>Common tools</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Inputs &amp; metadata</p></td>
<td><p>Sample sheet (CSV/TSV), PoN VCF, gnomAD resource, capture BED</p></td>
<td><p>Keep kit version, bait BED, genome build (GRCh38) and timepoint in metadata; verify fastq naming scheme.</p></td>
</tr>
<tr class="row-odd"><td><p>QC of raw reads</p></td>
<td><p>FastQC, MultiQC</p></td>
<td><p>Check per-base quality, adapter content, overrepresented sequences, duplication levels.</p></td>
</tr>
<tr class="row-even"><td><p>Trimming (optional)</p></td>
<td><p>fastp, Cutadapt</p></td>
<td><p>Use only if adapters/quality tails present; record trimming params for comparability across timepoints.</p></td>
</tr>
<tr class="row-odd"><td><p>Alignment</p></td>
<td><p>BWA-MEM2, samtools</p></td>
<td><p>Align to GRCh38 with consistent ALT/decoy handling; sort BAM by coordinate.</p></td>
</tr>
<tr class="row-even"><td><p>Post-alignment</p></td>
<td><p>GATK4, Picard, samtools</p></td>
<td><p>Mark duplicates; BQSR with dbSNP + Mills indels; index BAMs; capture metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>Somatic SNV/indel</p></td>
<td><p>GATK4 Mutect2 (+ PoN + gnomAD), FilterMutectCalls; optional Strelka2</p></td>
<td><p>Prefer tumor–normal; for tumor-only enforce stricter filtering and orthogonal review.</p></td>
</tr>
<tr class="row-even"><td><p>CNAs</p></td>
<td><p>CNVkit, EXCAVATOR2; optional FACETS or PureCN</p></td>
<td><p>Use matched normals or pooled normals; report purity/ploidy if using FACETS/PureCN.</p></td>
</tr>
<tr class="row-odd"><td><p>Clonality</p></td>
<td><p>PyClone-VI, SciClone, Ccube</p></td>
<td><p>Exclude CNA segments or use CNA-aware models; track clusters across timepoints.</p></td>
</tr>
<tr class="row-even"><td><p>Annotation</p></td>
<td><p>VEP, ANNOVAR, snpEff; bcftools</p></td>
<td><p>Add gene consequence, population AF, ClinVar/COSMIC; harmonize sample/genotype fields.</p></td>
</tr>
<tr class="row-odd"><td><p>Reporting</p></td>
<td><p>MultiQC, custom notebooks, markdown/Rmd</p></td>
<td><p>Summarize drivers, spectra, clonality, CNAs; include per-step software versions and references.</p></td>
</tr>
</tbody>
</table>
<section id="example-commands-bash">
<h2>Example commands (bash)<a class="headerlink" href="#example-commands-bash" title="Link to this heading"></a></h2>
<p><strong>0) Environment and references</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Conda env (example)</span>
conda<span class="w"> </span>create<span class="w"> </span>-y<span class="w"> </span>-n<span class="w"> </span>wes_cll<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bwa-mem2<span class="w"> </span>samtools<span class="w"> </span>fastqc<span class="w"> </span>multiqc<span class="w"> </span>fastp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>gatk4<span class="w"> </span>bcftools<span class="w"> </span>bedtools<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>ensembl-vep<span class="w"> </span>cnvkit<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span>-c<span class="w"> </span>bioconda
conda<span class="w"> </span>activate<span class="w"> </span>wes_cll

<span class="c1"># References (GRCh38) - adjust to your paths</span>
<span class="nv">REF</span><span class="o">=</span>GRCh38.fa
<span class="nv">DBSNP</span><span class="o">=</span>dbsnp_138.vcf.gz
<span class="nv">MILLS</span><span class="o">=</span>Mills_and_1000G_gold_standard.indels.hg38.vcf.gz
<span class="nv">GNOMAD_AF</span><span class="o">=</span>af-only-gnomad.hg38.vcf.gz
<span class="nv">PON</span><span class="o">=</span>pon.hg38.mutect2.vcf.gz
<span class="nv">BAIT_BED</span><span class="o">=</span>exome_targets_hg38.bed
</pre></div>
</div>
<p><strong>1) QC and optional trimming</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># FastQC and MultiQC</span>
fastqc<span class="w"> </span>tumor_R1.fq.gz<span class="w"> </span>tumor_R2.fq.gz<span class="w"> </span>normal_R1.fq.gz<span class="w"> </span>normal_R2.fq.gz<span class="w"> </span>-o<span class="w"> </span>qc/
multiqc<span class="w"> </span>qc/<span class="w"> </span>-o<span class="w"> </span>qc/

<span class="c1"># Optional trimming with fastp (HTML report included)</span>
fastp<span class="w"> </span>-i<span class="w"> </span>tumor_R1.fq.gz<span class="w"> </span>-I<span class="w"> </span>tumor_R2.fq.gz<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>-o<span class="w"> </span>tumor.trim.R1.fq.gz<span class="w"> </span>-O<span class="w"> </span>tumor.trim.R2.fq.gz<span class="w"> </span><span class="se">\</span>
<span class="w">      </span>--detect_adapter_for_pe<span class="w"> </span>--html<span class="w"> </span>qc/tumor_fastp.html
</pre></div>
</div>
<p><strong>2) Alignment and sorting</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">R1</span><span class="o">=</span>tumor.trim.R1.fq.gz
<span class="nv">R2</span><span class="o">=</span>tumor.trim.R2.fq.gz

bwa-mem2<span class="w"> </span>mem<span class="w"> </span>-t<span class="w"> </span><span class="m">16</span><span class="w"> </span>-R<span class="w"> </span><span class="s2">&quot;@RG\\tID:TUMOR\\tSM:TUMOR\\tPL:ILLUMINA&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="nv">$REF</span><span class="w"> </span><span class="nv">$R1</span><span class="w"> </span><span class="nv">$R2</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>samtools<span class="w"> </span>sort<span class="w"> </span>-@<span class="w"> </span><span class="m">8</span><span class="w"> </span>-o<span class="w"> </span>tumor.sorted.bam
samtools<span class="w"> </span>index<span class="w"> </span>tumor.sorted.bam

bwa-mem2<span class="w"> </span>mem<span class="w"> </span>-t<span class="w"> </span><span class="m">16</span><span class="w"> </span>-R<span class="w"> </span><span class="s2">&quot;@RG\\tID:NORMAL\\tSM:NORMAL\\tPL:ILLUMINA&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span><span class="nv">$REF</span><span class="w"> </span>normal_R1.fq.gz<span class="w"> </span>normal_R2.fq.gz<span class="w"> </span><span class="p">|</span><span class="w"> </span>samtools<span class="w"> </span>sort<span class="w"> </span>-@<span class="w"> </span><span class="m">8</span><span class="w"> </span>-o<span class="w"> </span>normal.sorted.bam
samtools<span class="w"> </span>index<span class="w"> </span>normal.sorted.bam
</pre></div>
</div>
<p><strong>3) Post-alignment processing (GATK4)</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gatk<span class="w"> </span>MarkDuplicates<span class="w"> </span>-I<span class="w"> </span>tumor.sorted.bam<span class="w"> </span>-O<span class="w"> </span>tumor.dedup.bam<span class="w"> </span>-M<span class="w"> </span>tumor.mkdup.txt
samtools<span class="w"> </span>index<span class="w"> </span>tumor.dedup.bam

gatk<span class="w"> </span>BaseRecalibrator<span class="w"> </span>-R<span class="w"> </span><span class="nv">$REF</span><span class="w"> </span>-I<span class="w"> </span>tumor.dedup.bam<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--known-sites<span class="w"> </span><span class="nv">$DBSNP</span><span class="w"> </span>--known-sites<span class="w"> </span><span class="nv">$MILLS</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-O<span class="w"> </span>tumor.recal.table
gatk<span class="w"> </span>ApplyBQSR<span class="w"> </span>-R<span class="w"> </span><span class="nv">$REF</span><span class="w"> </span>-I<span class="w"> </span>tumor.dedup.bam<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--bqsr-recal-file<span class="w"> </span>tumor.recal.table<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-O<span class="w"> </span>tumor.bqsr.bam
samtools<span class="w"> </span>index<span class="w"> </span>tumor.bqsr.bam

gatk<span class="w"> </span>MarkDuplicates<span class="w"> </span>-I<span class="w"> </span>normal.sorted.bam<span class="w"> </span>-O<span class="w"> </span>normal.dedup.bam<span class="w"> </span>-M<span class="w"> </span>normal.mkdup.txt
samtools<span class="w"> </span>index<span class="w"> </span>normal.dedup.bam

gatk<span class="w"> </span>BaseRecalibrator<span class="w"> </span>-R<span class="w"> </span><span class="nv">$REF</span><span class="w"> </span>-I<span class="w"> </span>normal.dedup.bam<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--known-sites<span class="w"> </span><span class="nv">$DBSNP</span><span class="w"> </span>--known-sites<span class="w"> </span><span class="nv">$MILLS</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-O<span class="w"> </span>normal.recal.table
gatk<span class="w"> </span>ApplyBQSR<span class="w"> </span>-R<span class="w"> </span><span class="nv">$REF</span><span class="w"> </span>-I<span class="w"> </span>normal.dedup.bam<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--bqsr-recal-file<span class="w"> </span>normal.recal.table<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-O<span class="w"> </span>normal.bqsr.bam
samtools<span class="w"> </span>index<span class="w"> </span>normal.bqsr.bam
</pre></div>
</div>
<p><strong>4) Somatic SNV/indel calling (Mutect2)</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gatk<span class="w"> </span>Mutect2<span class="w"> </span>-R<span class="w"> </span><span class="nv">$REF</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-I<span class="w"> </span>tumor.bqsr.bam<span class="w"> </span>-tumor<span class="w"> </span>TUMOR<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-I<span class="w"> </span>normal.bqsr.bam<span class="w"> </span>-normal<span class="w"> </span>NORMAL<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--germline-resource<span class="w"> </span><span class="nv">$GNOMAD_AF</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--panel-of-normals<span class="w"> </span><span class="nv">$PON</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--intervals<span class="w"> </span><span class="nv">$BAIT_BED</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-O<span class="w"> </span>tumor_vs_normal.unfiltered.vcf.gz

gatk<span class="w"> </span>LearnReadOrientationModel<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-I<span class="w"> </span>f1r2.tar.gz<span class="w"> </span>-O<span class="w"> </span>read-orientation-model.tar.gz<span class="w">  </span><span class="c1"># only if you collected F1R2 counts</span>

gatk<span class="w"> </span>GetPileupSummaries<span class="w"> </span>-I<span class="w"> </span>tumor.bqsr.bam<span class="w"> </span>-V<span class="w"> </span><span class="nv">$GNOMAD_AF</span><span class="w"> </span>-L<span class="w"> </span><span class="nv">$BAIT_BED</span><span class="w"> </span>-O<span class="w"> </span>tumor.pileups.table
gatk<span class="w"> </span>GetPileupSummaries<span class="w"> </span>-I<span class="w"> </span>normal.bqsr.bam<span class="w"> </span>-V<span class="w"> </span><span class="nv">$GNOMAD_AF</span><span class="w"> </span>-L<span class="w"> </span><span class="nv">$BAIT_BED</span><span class="w"> </span>-O<span class="w"> </span>normal.pileups.table
gatk<span class="w"> </span>CalculateContamination<span class="w"> </span>-I<span class="w"> </span>tumor.pileups.table<span class="w"> </span>-matched<span class="w"> </span>normal.pileups.table<span class="w"> </span>-O<span class="w"> </span>contamination.table

gatk<span class="w"> </span>FilterMutectCalls<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-R<span class="w"> </span><span class="nv">$REF</span><span class="w"> </span>-V<span class="w"> </span>tumor_vs_normal.unfiltered.vcf.gz<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--contamination-table<span class="w"> </span>contamination.table<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--ob-priors<span class="w"> </span>read-orientation-model.tar.gz<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-O<span class="w"> </span>tumor_vs_normal.filtered.vcf.gz

<span class="c1"># Optional second caller (Strelka2)</span>
configureStrelkaSomaticWorkflow.py<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--tumorBam<span class="w"> </span>tumor.bqsr.bam<span class="w"> </span>--normalBam<span class="w"> </span>normal.bqsr.bam<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--referenceFasta<span class="w"> </span><span class="nv">$REF</span><span class="w"> </span>--exome<span class="w"> </span>--callRegions<span class="w"> </span><span class="nv">$BAIT_BED</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--runDir<span class="w"> </span>strelka_run
strelka_run/runWorkflow.py<span class="w"> </span>-m<span class="w"> </span><span class="nb">local</span><span class="w"> </span>-j<span class="w"> </span><span class="m">16</span>
</pre></div>
</div>
<p><strong>5) CNAs (CNVkit example)</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build pooled normal reference (do once per kit)</span>
cnvkit.py<span class="w"> </span>batch<span class="w"> </span>normal*.bqsr.bam<span class="w"> </span>--normal<span class="w"> </span>--targets<span class="w"> </span><span class="nv">$BAIT_BED</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--fasta<span class="w"> </span><span class="nv">$REF</span><span class="w"> </span>--output-reference<span class="w"> </span>cnvkit_ref.cnn<span class="w"> </span>--output-dir<span class="w"> </span>cnvkit_norm_ref

<span class="c1"># Run tumor with pooled normal reference</span>
cnvkit.py<span class="w"> </span>batch<span class="w"> </span>tumor.bqsr.bam<span class="w"> </span>--targets<span class="w"> </span><span class="nv">$BAIT_BED</span><span class="w"> </span>--fasta<span class="w"> </span><span class="nv">$REF</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--reference<span class="w"> </span>cnvkit_ref.cnn<span class="w"> </span>--output-dir<span class="w"> </span>cnvkit_tumor

<span class="c1"># Segment and call</span>
cnvkit.py<span class="w"> </span>call<span class="w"> </span>cnvkit_tumor/tumor.bqsr.cns<span class="w"> </span>-o<span class="w"> </span>cnvkit_tumor/tumor.call.cns
</pre></div>
</div>
<p><strong>6) Clonality (PyClone-VI quick start)</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prepare input table with: mutation_id, ref_counts, var_counts, normal_cn, minor_cn, major_cn, tumor_content</span>
<span class="c1"># Use cnvkit/FACETS output to set copy-number and purity where possible.</span>

pyclone-vi<span class="w"> </span>fit<span class="w"> </span>--in-file<span class="w"> </span>pyclone_input.tsv<span class="w"> </span>--out-file<span class="w"> </span>pyclone_results.tsv<span class="w"> </span>--seed<span class="w"> </span><span class="m">13</span>
pyclone-vi<span class="w"> </span>write-results-file<span class="w"> </span>--in-file<span class="w"> </span>pyclone_results.tsv<span class="w"> </span>--out-file<span class="w"> </span>pyclone_posterior.tsv
<span class="c1"># Visualize clusters in R/python downstream</span>
</pre></div>
</div>
<p><strong>7) Annotation (VEP) and final packaging</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>vep<span class="w"> </span>-i<span class="w"> </span>tumor_vs_normal.filtered.vcf.gz<span class="w"> </span>-o<span class="w"> </span>tumor_vs_normal.vep.vcf<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--assembly<span class="w"> </span>GRCh38<span class="w"> </span>--cache<span class="w"> </span>--offline<span class="w"> </span>--vcf<span class="w"> </span>--everything<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--fork<span class="w"> </span><span class="m">8</span><span class="w"> </span>--species<span class="w"> </span>homo_sapiens

<span class="c1"># Basic VCF hygiene</span>
bcftools<span class="w"> </span>sort<span class="w"> </span>-Oz<span class="w"> </span>-o<span class="w"> </span>tumor_vs_normal.vep.sorted.vcf.gz<span class="w"> </span>tumor_vs_normal.vep.vcf
bcftools<span class="w"> </span>index<span class="w"> </span>-t<span class="w"> </span>tumor_vs_normal.vep.sorted.vcf.gz
</pre></div>
</div>
</section>
<section id="reproducibility-checklist">
<h2>Reproducibility checklist<a class="headerlink" href="#reproducibility-checklist" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Record software versions (e.g., <cite>conda env export &gt; env.yml</cite>) and container image digests if using Docker/Apptainer.</p></li>
<li><p>Pin reference assets: GRCh38 fasta, dbSNP, Mills indels, gnomAD AF, PoN, exome BED (with version and MD5).</p></li>
<li><p>Emit per-step metrics (dup rate, coverage, on-target %, contamination, TMB-like counts if needed).</p></li>
<li><p>Store command logs and MultiQC summary in the run folder.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="structure_and_containerisation.html" class="btn btn-neutral float-left" title="Pipeline Structure and Containerisation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="casestudy.html" class="btn btn-neutral float-right" title="Case Study: ITH-aware Somatic Interpretation for WGS/WES" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Akhilesh Kaushal.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>
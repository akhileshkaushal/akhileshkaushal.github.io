


<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Stage-to-Tool Mapping With Example Commands &mdash; WGS/WES Pipeline 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css?v=9482ece9" />

  
    <link rel="canonical" href="https://akhileshkaushal.github.io/wgswes/wes_cll_methods.html" />
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=4ebf8126"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Case Study: ITH-aware Somatic Interpretation for WGS/WES" href="casestudy1.html" />
    <link rel="prev" title="Pipeline Structure and Containerisation" href="structure_and_containerisation.html" />
   
  <link rel="icon" href="_static/images/favicon.ico">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            WGS/WES Pipeline
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Sections:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">WGS/WES Variant Calling Pipeline</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#use-cases">Use Cases</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#supported-data-types">Supported Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#when-to-choose-wgs-vs-wes">When to Choose WGS vs WES</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#design-principles">Design Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#high-level-workflow">High-Level Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#inputs-and-outputs">Inputs and Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#quality-coverage-and-qc">Quality, Coverage, and QC</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#filtering-strategy-notes">Filtering Strategy Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#reference-and-resource-recommendations">Reference and Resource Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#reproducibility-execution">Reproducibility &amp; Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#data-stewardship-compliance">Data Stewardship &amp; Compliance</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#limitations-non-goals">Limitations &amp; Non-Goals</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#whats-next">What’s Next</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="run_pipeline.html">Run the WGS/WES Pipeline</a><ul>
<li class="toctree-l2"><a class="reference internal" href="run_pipeline.html#pipeline-inputs-layout">Pipeline Inputs &amp; Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="run_pipeline.html#step-by-step-workflow">Step-by-Step Workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="run_pipeline.html#raw-read-qc">1) Raw Read QC</a></li>
<li class="toctree-l3"><a class="reference internal" href="run_pipeline.html#adapter-quality-trimming-optional-but-recommended-for-wes">2) Adapter/Quality Trimming (optional but recommended for WES)</a></li>
<li class="toctree-l3"><a class="reference internal" href="run_pipeline.html#alignment-to-reference">3) Alignment to Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="run_pipeline.html#duplicate-marking-bqsr">4) Duplicate Marking &amp; BQSR</a></li>
<li class="toctree-l3"><a class="reference internal" href="run_pipeline.html#variant-calling">5) Variant Calling</a></li>
<li class="toctree-l3"><a class="reference internal" href="run_pipeline.html#variant-filtering">6) Variant Filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="run_pipeline.html#annotation">7) Annotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="run_pipeline.html#cohort-level-qc-reports">8) Cohort-Level QC &amp; Reports</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="run_pipeline.html#parallelization-performance">Parallelization &amp; Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="run_pipeline.html#wes-specific-notes">WES-Specific Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="run_pipeline.html#expected-outputs">Expected Outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="run_pipeline.html#troubleshooting">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="run_pipeline.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="advanced_analysis.html">Advanced Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="advanced_analysis.html#trio-and-family-based-analysis">Trio and Family-Based Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_analysis.html#joint-calling-for-large-cohorts">Joint Calling for Large Cohorts</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_analysis.html#copy-number-variation-cnv-analysis">Copy Number Variation (CNV) Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_analysis.html#mitochondrial-variant-analysis">Mitochondrial Variant Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_analysis.html#tumor-purity-estimation-adjustment">Tumor Purity Estimation &amp; Adjustment</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_analysis.html#integration-and-reporting">Integration and Reporting</a></li>
<li class="toctree-l2"><a class="reference internal" href="advanced_analysis.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="annotated_example.html">Annotated Examples &amp; Interpretation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="annotated_example.html#example-tumornormal-variant-calling">Example: Tumor–Normal Variant Calling</a></li>
<li class="toctree-l2"><a class="reference internal" href="annotated_example.html#example-tumor-only-variant-calling">Example: Tumor-Only Variant Calling</a></li>
<li class="toctree-l2"><a class="reference internal" href="annotated_example.html#example-germline-variant-calling">Example: Germline Variant Calling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="structure_and_containerisation.html">Pipeline Structure and Containerisation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="structure_and_containerisation.html#modular-workflow-overview">Modular Workflow Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="structure_and_containerisation.html#support-for-germline-and-somatic-calling">Support for Germline and Somatic Calling</a></li>
<li class="toctree-l2"><a class="reference internal" href="structure_and_containerisation.html#containerisation">Containerisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="structure_and_containerisation.html#scalability-and-workflow-automation">Scalability and Workflow Automation</a></li>
<li class="toctree-l2"><a class="reference internal" href="structure_and_containerisation.html#example-directory-layout">Example Directory Layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="structure_and_containerisation.html#best-practices-for-execution">Best Practices for Execution</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Stage-to-Tool Mapping With Example Commands</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#example-commands-bash">Example Commands (Bash)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reproducibility-checklist">Reproducibility Checklist</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="casestudy1.html">Case Study: ITH-aware Somatic Interpretation for WGS/WES</a><ul>
<li class="toctree-l2"><a class="reference internal" href="casestudy1.html#what-was-built">What Was Built</a></li>
<li class="toctree-l2"><a class="reference internal" href="casestudy1.html#cohort-profiling-and-heterogeneity">Cohort Profiling and Heterogeneity</a></li>
<li class="toctree-l2"><a class="reference internal" href="casestudy1.html#drug-screening-and-response-definition">Drug Screening and Response Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="casestudy1.html#expression-signatures-predicting-response">Expression Signatures Predicting Response</a></li>
<li class="toctree-l2"><a class="reference internal" href="casestudy1.html#mechanism-of-lenvatinib-resistance-combination-strategy">Mechanism of Lenvatinib Resistance &amp; Combination Strategy</a></li>
<li class="toctree-l2"><a class="reference internal" href="casestudy1.html#ith-aware-somatic-interpretation-recommendations">ITH-aware Somatic Interpretation &amp; Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="casestudy1.html#limitations">Limitations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="casestudy2.html">Case Study: WES in Relapsing CLL: RPS15 Mutations and Clonal Evolution</a><ul>
<li class="toctree-l2"><a class="reference internal" href="casestudy2.html#what-was-built">What Was Built</a></li>
<li class="toctree-l2"><a class="reference internal" href="casestudy2.html#cohort-profiling-and-heterogeneity">Cohort Profiling and Heterogeneity</a></li>
<li class="toctree-l2"><a class="reference internal" href="casestudy2.html#genomic-profiling-methods-wes-focus">Genomic Profiling Methods (WES Focus)</a></li>
<li class="toctree-l2"><a class="reference internal" href="casestudy2.html#drug-screening-and-response-definition">Drug Screening and Response Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="casestudy2.html#expression-signatures-predicting-response">Expression Signatures Predicting Response</a></li>
<li class="toctree-l2"><a class="reference internal" href="casestudy2.html#mechanism-of-relapse-targeted-strategies">Mechanism of Relapse &amp; Targeted Strategies</a></li>
<li class="toctree-l2"><a class="reference internal" href="casestudy2.html#clonal-evolution-aware-somatic-interpretation-recommendations">Clonal Evolution-Aware Somatic Interpretation &amp; Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="casestudy2.html#limitations">Limitations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a><ul>
<li class="toctree-l2"><a class="reference internal" href="references.html#primary-study">Primary Study</a></li>
<li class="toctree-l2"><a class="reference internal" href="references.html#supporting-literature">Supporting Literature</a></li>
<li class="toctree-l2"><a class="reference internal" href="references.html#databases-and-resources">Databases and Resources</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">WGS/WES Pipeline</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Stage-to-Tool Mapping With Example Commands</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/wes_cll_methods.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="structure_and_containerisation.html" class="btn btn-neutral float-left" title="Pipeline Structure and Containerisation" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="casestudy1.html" class="btn btn-neutral float-right" title="Case Study: ITH-aware Somatic Interpretation for WGS/WES" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="stage-to-tool-mapping-with-example-commands">
<h1>Stage-to-Tool Mapping With Example Commands<a class="headerlink" href="#stage-to-tool-mapping-with-example-commands" title="Link to this heading"></a></h1>
<p>This section provides a comprehensive mapping of bioinformatics pipeline stages to commonly used tools, drawing from the workflows and methodologies highlighted in the two case studies: Yang et al. (2024) on pharmacogenomic profiling of intra-tumor heterogeneity in liver cancer, and Ljungström et al. (2016) on whole-exome sequencing in relapsing chronic lymphocytic leukemia (CLL). The tools are selected based on their relevance to whole-exome sequencing (WES), whole-genome sequencing (WGS), variant calling, copy number analysis, clonal evolution modeling, transcriptomic integration, and mutation signature analysis.</p>
<p>The table below outlines key stages, recommended tools (with latest versions as of August 2025, verified via web searches), and detailed notes on their application. Tools from the case studies are explicitly referenced, with modern equivalents or updates provided for reproducibility and performance. For instance, Yang et al. emphasized bwa-mem2 (v2.0 at the time, now v2.2.1) for alignment, GATK (v4.1.2.0, now v4.5.0.0) for variant calling, CNVkit (v0.9.7.b1, now v0.9.10) for CNAs, and Salmon/edgeR for RNA-seq. Ljungström et al. used BWA (v0.7.5, now v0.7.18), GATK (v2.8, now v4.5.0.0), ANNOVAR (2014-07-14, now 2024May25), FACETS (v0.3.9, now v0.6.2), SciClone (v1.0, now v1.1.0), DeconstructSigs (v1.6.0, now v1.9.0), MutSigCV (v1.41), and dNdScv (v0.1.0).</p>
<p>Where possible, tools are updated to their latest versions (e.g., GATK 4.5.0.0, ANNOVAR 2024May25) to leverage improvements in speed, accuracy, and compatibility. For ITH-aware and clonal evolution analyses, tools like PyClone-VI (v0.1.6), SciClone (v1.1.0), and FACETS (v0.6.2) are highlighted, with adaptations for multi-region or paired relapse samples. RNA-seq tools (e.g., STAR v2.7.11b, Salmon v1.10.3, edgeR v3.46.1, DESeq2 v1.44.0) are included for transcriptomic integration, as in Yang et al. Mutation signature tools (e.g., SigProfiler v1.1.25, DeconstructSigs v1.9.0, MutSigCV v1.41, dNdScv v0.1.0) are added for downstream analyses.</p>
<p>The example commands use Bash scripts with modern versions, assuming a Linux/Unix environment (e.g., Ubuntu 24.04). Commands are verbose, with explanations inline. Use containers (Docker/Singularity) for reproducibility, as in the case studies (e.g., GATK Docker images). All paths are placeholders; replace with actual values.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18.0%" />
<col style="width: 22.0%" />
<col style="width: 60.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Stage</p></th>
<th class="head"><p>Common Tools (Latest Versions)</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Inputs &amp; Metadata</p></td>
<td><p>Sample sheet (CSV/TSV), PoN VCF (e.g., from GATK v4.5.0.0), gnomAD resource (v4.1), capture BED (e.g., Agilent SureSelect v6)</p></td>
<td><p>Prepare metadata with sample IDs, tumor-normal pairs, timepoints (pre/post-relapse in CLL), regions (multi-region in liver cancer). Include genome build (GRCh38/hg38 preferred). Verify FASTQ naming for paired-end reads. From studies: Yang used multi-regional samples; Ljungström used paired pre/post-relapse. Use CSV for compatibility with tools like GATK and DESeq2.</p></td>
</tr>
<tr class="row-odd"><td><p>QC of Raw Reads</p></td>
<td><p>FastQC (v0.12.1), MultiQC (v1.30)</p></td>
<td><p>Assess per-base quality, adapters, overrepresented sequences, duplication. MultiQC aggregates across samples. In studies: Yang and Ljungström emphasized QC before alignment. For RNA-seq, check GC bias. Use –threads for speed.</p></td>
</tr>
<tr class="row-even"><td><p>Trimming (Optional)</p></td>
<td><p>fastp (v1.0.1), Cutadapt (v5.1)</p></td>
<td><p>Trim adapters/low-quality tails. fastp is all-in-one (QC+trim+filter). From Yang: Used for RNA-seq preprocessing. Skip if data is clean; record params for ITH consistency.</p></td>
</tr>
<tr class="row-odd"><td><p>Alignment</p></td>
<td><p>bwa-mem2 (v2.2.1), STAR (v2.7.11b), Salmon (v1.10.3) for quasi-mapping</p></td>
<td><p>Align to GRCh38. bwa-mem2 for WES/WGS (Yang/Ljungström). STAR for RNA-seq (Yang). Salmon for transcript quasi-mapping. Handle multi-region/relapse by aligning per sample. Mark duplicates post-alignment.</p></td>
</tr>
<tr class="row-even"><td><p>Post-Alignment Processing</p></td>
<td><p>GATK (v4.5.0.0), Picard (v3.2.0), samtools (v1.22.1)</p></td>
<td><p>Mark duplicates, BQSR, index BAMs. GATK for recalibration (both studies). samtools for sorting/indexing. Essential for variant calling accuracy in heterogeneous samples.</p></td>
</tr>
<tr class="row-odd"><td><p>Somatic SNV/Indel Calling</p></td>
<td><p>GATK Mutect2 (v4.5.0.0), Strelka2 (v2.9.10)</p></td>
<td><p>Tumor-normal paired mode (prioritized in both studies). Filter with PoN/gnomAD. Yang used MuTect v2.0; Ljungström v1.1.4. Adjust VAF thresholds for subclones.</p></td>
</tr>
<tr class="row-even"><td><p>CNAs</p></td>
<td><p>CNVkit (v0.9.10), FACETS (v0.6.2), GISTIC (v2.0.23)</p></td>
<td><p>CNVkit for segmentation (Yang). FACETS for purity/ploidy (Ljungström). GISTIC for focal events. ITH-aware: Quantify CNA-ITH (Yang). Use matched normals.</p></td>
</tr>
<tr class="row-odd"><td><p>Clonality &amp; Evolution</p></td>
<td><p>PyClone-VI (v0.1.6), SciClone (v1.1.0), FACETS (v0.6.2)</p></td>
<td><p>SciClone for subclonal clustering (Ljungström). PyClone-VI for ITH (modern alternative). Integrate VAF/CN for CCF. Phylogenetic trees with MEGA (v12.0.13, both studies).</p></td>
</tr>
<tr class="row-even"><td><p>Annotation</p></td>
<td><p>ANNOVAR (2024May25), Ensembl VEP (v110)</p></td>
<td><p>Functional impact, COSMIC/ClinVar. ANNOVAR in both studies (2019-10/2014-07). VEP for modern updates. Handle multi-allelic variants.</p></td>
</tr>
<tr class="row-odd"><td><p>Mutation Signatures</p></td>
<td><p>SigProfiler (v1.1.25), DeconstructSigs (v1.9.0), MutSigCV (v1.41), dNdScv (v0.1.0)</p></td>
<td><p>DeconstructSigs/MutSigCV/dNdScv for signatures (Ljungström). SigProfiler for de novo extraction. Analyze per-region/timepoint for evolution.</p></td>
</tr>
<tr class="row-even"><td><p>Transcriptomics (RNA-seq)</p></td>
<td><p>STAR (v2.7.11b), Salmon (v1.10.3), edgeR (v3.46.1), DESeq2 (v1.44.0)</p></td>
<td><p>STAR for alignment, Salmon for quasi-mapping (Yang). edgeR/DESeq2 for DE/signatures. Integrate with WES for multi-omics ITH.</p></td>
</tr>
<tr class="row-odd"><td><p>Reporting &amp; Visualization</p></td>
<td><p>MultiQC (v1.30), R/ggplot2 (v3.5.1)</p></td>
<td><p>Aggregate QC/reports. Custom plots for phylogenies (MEGA), signatures. Studies used R for visualizations.</p></td>
</tr>
</tbody>
</table>
<p>A key aspect of the pipeline, particularly relevant to the case studies, is handling intra-tumor heterogeneity (ITH) and clonal evolution. This builds directly on the Clonality &amp; Evolution stage, providing specialized adaptations for multi-region (liver cancer) and paired relapse (CLL) analyses to classify trunk/branch variants, compute cancer cell fractions (CCF), and reconstruct phylogenies.</p>
<p>ITH/Evolution Adaptations: Intra-tumor heterogeneity (ITH) and clonal evolution are critical in cancers like primary liver cancer (PLC) and chronic lymphocytic leukemia (CLL), as highlighted in the case studies. In Yang et al. (2024), multi-region sampling revealed branch-dominant ITH (region-specific mutations/CNAs) linked to drug resistance, with trunk mutations shared across regions (early events) and branch mutations private (late events). Trunk/branch classification uses phylogenetic reconstruction to infer evolutionary trees. In Ljungström et al. (2016), paired pre/post-relapse samples showed subclonal expansion (e.g., TP53 clones), quantified via cancer cell fraction (CCF) to track dynamics.</p>
<p>For multi-region analysis (e.g., liver cancer from Yang et al.), first consolidate VCFs from individual regions using bcftools to create a multi-sample VCF, then classify variants as trunk (shared across all regions, CCF &gt;0.9 in all), branch (shared in subsets), or private (region-specific). Use phylogenetic tools like MEGA (v12.0.13, command-line MEGA-CC for automation) for tree building based on binary presence/absence matrices, or PyClone-VI (v0.1.6) for probabilistic clustering integrating VAF and CN. Compute trunk ratio (TR = trunk mutations / branch mutations) in R/Python for ITH quantification.</p>
<p>For paired relapse analysis (e.g., CLL from Ljungström et al.), compute CCF with FACETS (v0.6.2) to adjust VAF for purity/ploidy, enabling subclonal inference (e.g., expansion if CCF increases post-relapse). FACETS outputs segments and fits for downstream tools like SciClone.</p>
<p><strong>Bash Scripts for Multi-Region (Liver Cancer - Consolidate and Classify)</strong></p>
<p>Prepare a presence/absence matrix from consolidated VCF (e.g., using bcftools query to extract variants per region), then build trees.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assume VCFs: region1.vcf.gz, region2.vcf.gz, region3.vcf.gz</span>
<span class="c1"># Step 1: Consolidate VCFs (merge multi-sample)</span>
bcftools<span class="w"> </span>merge<span class="w"> </span>-Oz<span class="w"> </span>-o<span class="w"> </span>multi_region.vcf.gz<span class="w"> </span>region1.filtered.vcf.gz<span class="w"> </span>region2.filtered.vcf.gz<span class="w"> </span>region3.filtered.vcf.gz
bcftools<span class="w"> </span>index<span class="w"> </span>multi_region.vcf.gz

<span class="c1"># Step 2: Extract presence/absence (custom Python/R; example with bcftools + awk for binary matrix)</span>
<span class="c1"># Create binary matrix: rows=variants, columns=regions (1 if ALT&gt;0, 0 otherwise)</span>
bcftools<span class="w"> </span>query<span class="w"> </span>-f<span class="w"> </span><span class="s1">&#39;%CHROM\t%POS\t%REF\t%ALT[\t%GT]\n&#39;</span><span class="w"> </span>multi_region.vcf.gz<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span><span class="s1">&#39;BEGIN {print &quot;Variant\tRegion1\tRegion2\tRegion3&quot;} {var=$1&quot;:&quot;$2&quot;:&quot;$3&quot;:&quot;$4; r1=($5!=&quot;0/0&quot; &amp;&amp; $5!=&quot;./.&quot;)?1:0; r2=($6!=&quot;0/0&quot; &amp;&amp; $6!=&quot;./.&quot;)?1:0; r3=($7!=&quot;0/0&quot; &amp;&amp; $7!=&quot;./.&quot;)?1:0; print var&quot;\t&quot;r1&quot;\t&quot;r2&quot;\t&quot;r3}&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>presence_matrix.tsv

<span class="c1"># Step 3: Phylogenetic tree with MEGA-CC (command-line; assumes MEGA-CC installed)</span>
<span class="c1"># Convert to MEGA format (.meg) via custom script, then:</span>
megacc<span class="w"> </span>-a<span class="w"> </span>neighbor_joining.mao<span class="w"> </span>-d<span class="w"> </span>presence_matrix.meg<span class="w"> </span>-o<span class="w"> </span>tree.nwk<span class="w">  </span><span class="c1"># Neighbor-joining tree</span>

<span class="c1"># Alternative: PyClone-VI (v0.1.6) for clustering (prepare input with VAF/CN per region)</span>
<span class="c1"># Input: tsv with mutation_id, ref_counts, var_counts, normal_cn, minor_cn, major_cn per region</span>
pyclone-vi<span class="w"> </span>fit<span class="w"> </span>--in-file<span class="w"> </span>multi_region_input.tsv<span class="w"> </span>--out-file<span class="w"> </span>pyclone_results.h5<span class="w"> </span>--num-clusters<span class="w"> </span><span class="m">5</span><span class="w"> </span>--num-restarts<span class="w"> </span><span class="m">100</span><span class="w"> </span>--seed<span class="w"> </span><span class="m">42</span>
pyclone-vi<span class="w"> </span>write-results-file<span class="w"> </span>--in-file<span class="w"> </span>pyclone_results.h5<span class="w"> </span>--out-file<span class="w"> </span>pyclone_posterior.tsv

<span class="c1"># Step 4: Classify trunk/branch (custom R/Python; example R snippet)</span>
Rscript<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;matrix &lt;- read.table(&quot;presence_matrix.tsv&quot;, header=TRUE); trunk &lt;- rowSums(matrix[,2:4]) == 3; branch &lt;- rowSums(matrix[,2:4]) &gt; 1 &amp; rowSums(matrix[,2:4]) &lt; 3; private &lt;- rowSums(matrix[,2:4]) == 1; cat(&quot;TR =&quot;, sum(trunk)/sum(branch), &quot;\n&quot;)&#39;</span>

<span class="c1"># Explanation: Merge VCFs, create binary matrix, build tree (MEGA for parsimony), or cluster (PyClone-VI Bayesian). TR quantifies ITH (Yang: TR &gt;1 trunk-dominant).</span>
</pre></div>
</div>
<p><strong>Bash Scripts for Paired Relapse (CLL - Compute CCF with FACETS)</strong></p>
<p>FACETS is R-based; wrap in Rscript or use facets-suite wrapper.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install FACETS if needed (in R: install.packages(&quot;facets&quot;))</span>
<span class="c1"># Run FACETS (v0.6.2) via Rscript</span>
Rscript<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;library(facets); snp_pileup(&quot;tumor.bam&quot;, &quot;normal.bam&quot;, &quot;snp_positions.gz&quot;, output_file=&quot;pileup.dat.gz&quot;); preProcSample(&quot;pileup.dat.gz&quot;, snp.nbhd=250, ndepth=35, cval=25); procSample(rcmat, cval=150); fit &lt;- emcncf(xx); write.table(fit$cncf, &quot;facets_cncf.tsv&quot;, sep=&quot;\t&quot;, quote=FALSE, row.names=FALSE)&#39;</span>

<span class="c1"># Alternative using facets-suite wrapper (if installed: https://github.com/mskcc/facets-suite)</span>
run-facets-wrapper.R<span class="w"> </span>--tumor-bam<span class="w"> </span>tumor.bam<span class="w"> </span>--normal-bam<span class="w"> </span>normal.bam<span class="w"> </span>--output-prefix<span class="w"> </span>output<span class="w"> </span>--snp-vcf<span class="w"> </span>snp_positions.vcf.gz<span class="w"> </span>--cval-preproc<span class="w"> </span><span class="m">25</span><span class="w"> </span>--cval-proc<span class="w"> </span><span class="m">150</span><span class="w"> </span>--ndepth<span class="w"> </span><span class="m">35</span>

<span class="c1"># Compute CCF (post-FACETS; custom)</span>
<span class="c1"># Use fit$cncf for segments; for variants, adjust VAF: CCF = (VAF * purity) / ( (2 * (1 - purity)) + (purity * total_cn) )</span>
Rscript<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;variants &lt;- read.table(&quot;variants.tsv&quot;, header=TRUE); purity &lt;- 0.8; # from FACETS; ccf &lt;- (variants$VAF * purity) / ((2 * (1 - purity)) + (purity * variants$total_cn)); write.table(ccf, &quot;ccf.tsv&quot;)&#39;</span>

<span class="c1"># Explanation: FACETS estimates purity/ploidy/CN segments (Ljungström). Compute CCF for each variant to detect expansion (e.g., if CCF_post &gt; CCF_pre). Integrate with SciClone for clustering. For relapse, compare pre/post CCF to identify selected subclones (e.g., RPS15/TP53).</span>
</pre></div>
</div>
<section id="example-commands-bash">
<h2>Example Commands (Bash)<a class="headerlink" href="#example-commands-bash" title="Link to this heading"></a></h2>
<p><strong>0) Environment and References</strong></p>
<p>Set up a Conda environment for reproducibility, incorporating tools from studies.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create Conda env with key tools</span>
conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>cancer_pipeline<span class="w"> </span>-y<span class="w"> </span><span class="nv">python</span><span class="o">=</span><span class="m">3</span>.11<span class="w"> </span>r-base<span class="o">=</span><span class="m">4</span>.4.1
conda<span class="w"> </span>activate<span class="w"> </span>cancer_pipeline
conda<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>bioconda<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span>bwa-mem2<span class="o">=</span><span class="m">2</span>.2.1<span class="w"> </span><span class="nv">gatk4</span><span class="o">=</span><span class="m">4</span>.5.0.0<span class="w"> </span><span class="nv">annovar</span><span class="o">=</span>2024may25<span class="w"> </span><span class="nv">cnvkit</span><span class="o">=</span><span class="m">0</span>.9.10<span class="w"> </span>pyclone-vi<span class="o">=</span><span class="m">0</span>.1.6<span class="w"> </span><span class="nv">facets</span><span class="o">=</span><span class="m">0</span>.6.2<span class="w"> </span><span class="nv">sciclone</span><span class="o">=</span><span class="m">1</span>.1.0<span class="w"> </span><span class="nv">sigprofiler</span><span class="o">=</span><span class="m">1</span>.1.25<span class="w"> </span><span class="nv">deconstructsigs</span><span class="o">=</span><span class="m">1</span>.9.0<span class="w"> </span><span class="nv">mutsigcv</span><span class="o">=</span><span class="m">1</span>.41<span class="w"> </span><span class="nv">dndscv</span><span class="o">=</span><span class="m">0</span>.1.0<span class="w"> </span><span class="nv">star</span><span class="o">=</span><span class="m">2</span>.7.11b<span class="w"> </span><span class="nv">salmon</span><span class="o">=</span><span class="m">1</span>.10.3<span class="w"> </span>bioconductor-edger<span class="o">=</span><span class="m">3</span>.46.1<span class="w"> </span>bioconductor-deseq2<span class="o">=</span><span class="m">1</span>.44.0<span class="w"> </span><span class="nv">fastqc</span><span class="o">=</span><span class="m">0</span>.12.1<span class="w"> </span><span class="nv">multiqc</span><span class="o">=</span><span class="m">1</span>.30<span class="w"> </span><span class="nv">fastp</span><span class="o">=</span><span class="m">1</span>.0.1<span class="w"> </span><span class="nv">bcftools</span><span class="o">=</span><span class="m">1</span>.22.1<span class="w"> </span><span class="nv">samtools</span><span class="o">=</span><span class="m">1</span>.22.1
conda<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>r<span class="w"> </span>r-ggplot2<span class="o">=</span><span class="m">3</span>.5.1

<span class="c1"># References (GRCh38)</span>
<span class="nv">REF</span><span class="o">=</span>GRCh38.fa<span class="w">  </span><span class="c1"># From Ensembl/UCSC</span>
<span class="nv">DBSNP</span><span class="o">=</span>dbsnp_156.vcf.gz<span class="w">  </span><span class="c1"># Latest dbSNP v156</span>
<span class="nv">MILLS</span><span class="o">=</span>Mills_and_1000G_gold_standard.indels.hg38.vcf.gz
<span class="nv">GNOMAD_AF</span><span class="o">=</span>gnomad.v4.1.vcf.gz<span class="w">  </span><span class="c1"># Latest gnomAD v4.1</span>
<span class="nv">PON</span><span class="o">=</span>pon.hg38.mutect2.vcf.gz<span class="w">  </span><span class="c1"># Panel of normals</span>
<span class="nv">BAIT_BED</span><span class="o">=</span>exome_targets_hg38.bed<span class="w">  </span><span class="c1"># e.g., Agilent SureSelect v6</span>
</pre></div>
</div>
<p><strong>1) QC and Optional Trimming</strong></p>
<p>Perform QC with FastQC/MultiQC; trim with fastp if needed.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># FastQC and MultiQC</span>
mkdir<span class="w"> </span>qc
fastqc<span class="w"> </span>tumor_R1.fq.gz<span class="w"> </span>tumor_R2.fq.gz<span class="w"> </span>normal_R1.fq.gz<span class="w"> </span>normal_R2.fq.gz<span class="w"> </span>-o<span class="w"> </span>qc/<span class="w"> </span>--threads<span class="w"> </span><span class="m">16</span>
multiqc<span class="w"> </span>qc/<span class="w"> </span>-o<span class="w"> </span>qc/<span class="w"> </span>--verbose

<span class="c1"># Trimming with fastp (all-in-one QC+trim)</span>
fastp<span class="w"> </span>-i<span class="w"> </span>tumor_R1.fq.gz<span class="w"> </span>-I<span class="w"> </span>tumor_R2.fq.gz<span class="w"> </span>-o<span class="w"> </span>tumor.trim.R1.fq.gz<span class="w"> </span>-O<span class="w"> </span>tumor.trim.R2.fq.gz<span class="w"> </span>--detect_adapter_for_pe<span class="w"> </span>--html<span class="w"> </span>qc/tumor_fastp.html<span class="w"> </span>--thread<span class="w"> </span><span class="m">16</span><span class="w"> </span>--report_title<span class="w"> </span><span class="s2">&quot;Tumor QC Report&quot;</span>

<span class="c1"># Explanation: fastp (from Yang) is faster than Cutadapt; use for adapters/low-quality. MultiQC aggregates for multi-sample ITH (Yang/Ljungström).</span>
</pre></div>
</div>
<p><strong>2) Alignment and Sorting</strong></p>
<p>Align with bwa-mem2 (DNA) or STAR (RNA); sort/index with samtools.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># DNA alignment (bwa-mem2 from both studies)</span>
<span class="nv">R1</span><span class="o">=</span>tumor.trim.R1.fq.gz
<span class="nv">R2</span><span class="o">=</span>tumor.trim.R2.fq.gz
bwa-mem2<span class="w"> </span>mem<span class="w"> </span>-t<span class="w"> </span><span class="m">16</span><span class="w"> </span>-R<span class="w"> </span><span class="s2">&quot;@RG\tID:TUMOR\tSM:TUMOR\tPL:ILLUMINA&quot;</span><span class="w"> </span><span class="nv">$REF</span><span class="w"> </span><span class="nv">$R1</span><span class="w"> </span><span class="nv">$R2</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>samtools<span class="w"> </span>sort<span class="w"> </span>-@<span class="w"> </span><span class="m">16</span><span class="w"> </span>-o<span class="w"> </span>tumor.sorted.bam<span class="w"> </span>-
samtools<span class="w"> </span>index<span class="w"> </span>-@<span class="w"> </span><span class="m">16</span><span class="w"> </span>tumor.sorted.bam

<span class="c1"># RNA-seq alignment (STAR from Yang)</span>
mkdir<span class="w"> </span>star_out
STAR<span class="w"> </span>--runThreadN<span class="w"> </span><span class="m">16</span><span class="w"> </span>--genomeDir<span class="w"> </span>star_index<span class="w"> </span>--readFilesIn<span class="w"> </span>rna_R1.fq.gz<span class="w"> </span>rna_R2.fq.gz<span class="w"> </span>--readFilesCommand<span class="w"> </span>zcat<span class="w"> </span>--outFileNamePrefix<span class="w"> </span>star_out/<span class="w"> </span>--outSAMtype<span class="w"> </span>BAM<span class="w"> </span>SortedByCoordinate<span class="w"> </span>--quantMode<span class="w"> </span>TranscriptomeSAM<span class="w"> </span>GeneCounts<span class="w"> </span>--twopassMode<span class="w"> </span>Basic

<span class="c1"># Explanation: bwa-mem2 for WES/WGS (faster than BWA v0.7.18). STAR for spliced RNA alignment. Handle relapse pairs separately (Ljungström).</span>
</pre></div>
</div>
<p><strong>3) Post-Alignment Processing (GATK4)</strong></p>
<p>Mark duplicates, recalibrate.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gatk<span class="w"> </span>MarkDuplicates<span class="w"> </span>-I<span class="w"> </span>tumor.sorted.bam<span class="w"> </span>-O<span class="w"> </span>tumor.dedup.bam<span class="w"> </span>-M<span class="w"> </span>tumor.mkdup.txt<span class="w"> </span>--CREATE_INDEX<span class="w"> </span><span class="nb">true</span>
gatk<span class="w"> </span>BaseRecalibrator<span class="w"> </span>-R<span class="w"> </span><span class="nv">$REF</span><span class="w"> </span>-I<span class="w"> </span>tumor.dedup.bam<span class="w"> </span>--known-sites<span class="w"> </span><span class="nv">$DBSNP</span><span class="w"> </span>--known-sites<span class="w"> </span><span class="nv">$MILLS</span><span class="w"> </span>-O<span class="w"> </span>tumor.recal.table
gatk<span class="w"> </span>ApplyBQSR<span class="w"> </span>-R<span class="w"> </span><span class="nv">$REF</span><span class="w"> </span>-I<span class="w"> </span>tumor.dedup.bam<span class="w"> </span>--bqsr-recal-file<span class="w"> </span>tumor.recal.table<span class="w"> </span>-O<span class="w"> </span>tumor.bqsr.bam

<span class="c1"># Similar for normal BAM</span>
<span class="c1"># Explanation: GATK (v4.5.0.0 update from studies) for BQSR. Essential for accurate variant calling in heterogeneous tumors.</span>
</pre></div>
</div>
<p><strong>4) Somatic SNV/Indel Calling (Mutect2)</strong></p>
<p>Call variants.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gatk<span class="w"> </span>Mutect2<span class="w"> </span>-R<span class="w"> </span><span class="nv">$REF</span><span class="w"> </span>-I<span class="w"> </span>tumor.bqsr.bam<span class="w"> </span>-tumor<span class="w"> </span>TUMOR<span class="w"> </span>-I<span class="w"> </span>normal.bqsr.bam<span class="w"> </span>-normal<span class="w"> </span>NORMAL<span class="w"> </span>--germline-resource<span class="w"> </span><span class="nv">$GNOMAD_AF</span><span class="w"> </span>--panel-of-normals<span class="w"> </span><span class="nv">$PON</span><span class="w"> </span>--intervals<span class="w"> </span><span class="nv">$BAIT_BED</span><span class="w"> </span>-O<span class="w"> </span>tumor_vs_normal.unfiltered.vcf.gz

gatk<span class="w"> </span>FilterMutectCalls<span class="w"> </span>-R<span class="w"> </span><span class="nv">$REF</span><span class="w"> </span>-V<span class="w"> </span>tumor_vs_normal.unfiltered.vcf.gz<span class="w"> </span>--contamination-table<span class="w"> </span>contamination.table<span class="w"> </span>-O<span class="w"> </span>tumor_vs_normal.filtered.vcf.gz

<span class="c1"># Explanation: Mutect2 (GATK) for somatic calls (Yang/Ljungström). Use PoN for artifacts. Adjust for low-VAF subclones.</span>
</pre></div>
</div>
<p><strong>5) CNAs (CNVkit &amp; FACETS)</strong></p>
<p>Detect CNAs.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># CNVkit (Yang)</span>
cnvkit.py<span class="w"> </span>batch<span class="w"> </span>tumor.bqsr.bam<span class="w"> </span>--normal<span class="w"> </span>normal.bqsr.bam<span class="w"> </span>--targets<span class="w"> </span><span class="nv">$BAIT_BED</span><span class="w"> </span>--fasta<span class="w"> </span><span class="nv">$REF</span><span class="w"> </span>--output-reference<span class="w"> </span>cnvkit_ref.cnn<span class="w"> </span>--output-dir<span class="w"> </span>cnvkit_out
cnvkit.py<span class="w"> </span>call<span class="w"> </span>cnvkit_out/tumor.bqsr.cns<span class="w"> </span>-o<span class="w"> </span>cnvkit_out/tumor.call.cns

<span class="c1"># FACETS (Ljungström)</span>
Rscript<span class="w"> </span>facets.R<span class="w"> </span>--tumor<span class="w"> </span>tumor.bqsr.bam<span class="w"> </span>--normal<span class="w"> </span>normal.bqsr.bam<span class="w"> </span>--output<span class="w"> </span>facets_out

<span class="c1"># Explanation: CNVkit for segmentation; FACETS for purity/ploidy in subclonal analysis. Quantify CNA-ITH (Yang).</span>
</pre></div>
</div>
<p><strong>6) Clonality (PyClone-VI &amp; SciClone)</strong></p>
<p>Infer subclones.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># SciClone (Ljungström)</span>
Rscript<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;library(sciClone); sciClone(vafs=..., copyNumberCalls=..., sampleNames=..., outputFile=&#39;clones&#39;)&quot;</span>

<span class="c1"># PyClone-VI (modern)</span>
pyclone-vi<span class="w"> </span>fit<span class="w"> </span>--in-file<span class="w"> </span>pyclone_input.tsv<span class="w"> </span>--out-file<span class="w"> </span>pyclone_results.tsv<span class="w"> </span>--seed<span class="w"> </span><span class="m">13</span>

<span class="c1"># Explanation: SciClone for VAF clustering; PyClone-VI for Bayesian ITH (update). Use multi-timepoint (CLL) or regions (liver).</span>
</pre></div>
</div>
<p><strong>7) Annotation (ANNOVAR &amp; VEP)</strong></p>
<p>Annotate variants.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># ANNOVAR (both studies)</span>
perl<span class="w"> </span>table_annovar.pl<span class="w"> </span>filtered.vcf<span class="w"> </span>humandb/<span class="w"> </span>-buildver<span class="w"> </span>hg38<span class="w"> </span>-out<span class="w"> </span>annotated<span class="w"> </span>-protocol<span class="w"> </span>refGene,cosmic70,clinvar<span class="w"> </span>-operation<span class="w"> </span>g,f,f

<span class="c1"># VEP (modern)</span>
vep<span class="w"> </span>-i<span class="w"> </span>filtered.vcf.gz<span class="w"> </span>-o<span class="w"> </span>annotated.vep.vcf<span class="w"> </span>--assembly<span class="w"> </span>GRCh38<span class="w"> </span>--cache<span class="w"> </span>--offline<span class="w"> </span>--vcf<span class="w"> </span>--everything<span class="w"> </span>--fork<span class="w"> </span><span class="m">16</span>

<span class="c1"># Explanation: ANNOVAR for functional impact; VEP for detailed consequences. Handle branch-private variants.</span>
</pre></div>
</div>
<p><strong>8) Mutation Signatures (SigProfiler &amp; DeconstructSigs)</strong></p>
<p>Extract signatures.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># DeconstructSigs (Ljungström)</span>
Rscript<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;library(deconstructSigs); whichSignatures(sigs.input=..., signatures.ref=signatures.cosmic)&quot;</span>

<span class="c1"># SigProfiler (modern)</span>
python<span class="w"> </span>-m<span class="w"> </span>sigProfilerExtractor<span class="w"> </span>sigprofiler_extract<span class="w"> </span>input<span class="w"> </span>output<span class="w"> </span>project

<span class="c1"># Explanation: DeconstructSigs for known signatures; SigProfiler for de novo. Analyze per-subclone (ITH-aware).</span>
</pre></div>
</div>
<p><strong>9) Transcriptomics (STAR, Salmon, edgeR, DESeq2)</strong></p>
<p>Process RNA-seq.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># STAR alignment</span>
STAR<span class="w"> </span>--runThreadN<span class="w"> </span><span class="m">16</span><span class="w"> </span>--genomeDir<span class="w"> </span>star_index<span class="w"> </span>--readFilesIn<span class="w"> </span>rna_R1.fq.gz<span class="w"> </span>rna_R2.fq.gz<span class="w"> </span>--outSAMtype<span class="w"> </span>BAM<span class="w"> </span>SortedByCoordinate

<span class="c1"># Salmon quantification</span>
salmon<span class="w"> </span>quant<span class="w"> </span>-i<span class="w"> </span>transcripts_index<span class="w"> </span>-l<span class="w"> </span>A<span class="w"> </span>-1<span class="w"> </span>rna_R1.fq.gz<span class="w"> </span>-2<span class="w"> </span>rna_R2.fq.gz<span class="w"> </span>-o<span class="w"> </span>quant_out<span class="w"> </span>--gcBias

<span class="c1"># DE with DESeq2</span>
Rscript<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;library(DESeq2); dds &lt;- DESeqDataSetFromMatrix(countData=..., colData=..., design=~condition); dds &lt;- DESeq(dds); res &lt;- results(dds)&quot;</span>

<span class="c1"># Explanation: STAR/Salmon for alignment/quant (Yang). edgeR/DESeq2 for signatures/DE. Integrate for multi-omic ITH.</span>
</pre></div>
</div>
<p><strong>10) Reporting (MultiQC &amp; Custom)</strong></p>
<p>Aggregate results.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>multiqc<span class="w"> </span>.<span class="w"> </span>-o<span class="w"> </span>multiqc_report<span class="w"> </span>--verbose

<span class="c1"># Custom R for phylogenies/signatures</span>
Rscript<span class="w"> </span>visualize.R

<span class="c1"># Explanation: MultiQC for QC aggregation. Custom scripts for ITH plots (MEGA, ggplot2 from studies).</span>
</pre></div>
</div>
</section>
<section id="reproducibility-checklist">
<h2>Reproducibility Checklist<a class="headerlink" href="#reproducibility-checklist" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Use Conda/Docker for envs (e.g., GATK Docker).</p></li>
<li><p>Record versions (conda env export &gt; env.yml).</p></li>
<li><p>Pin references (MD5 checksums).</p></li>
<li><p>Emit metrics (dup rate, coverage, TMB).</p></li>
<li><p>Store logs/MultiQC in run folder. For ITH, track per-region metrics.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="structure_and_containerisation.html" class="btn btn-neutral float-left" title="Pipeline Structure and Containerisation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="casestudy1.html" class="btn btn-neutral float-right" title="Case Study: ITH-aware Somatic Interpretation for WGS/WES" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Akhilesh Kaushal.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>